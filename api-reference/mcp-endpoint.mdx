---
title: "MCP Endpoint"
description: "JSON-RPC 2.0 Model Context Protocol endpoint for AI agents"
---

## Overview

The MCP endpoint is the primary interface for AI agents to interact with your published tools. It implements the **Model Context Protocol** using **JSON-RPC 2.0** over HTTP.

## Endpoint

```
POST https://app.surfdata.io/mcp/http
```

### Authentication

```
Authorization: Bearer sk_live_<your-token>
```

### Content type

```
Content-Type: application/json
```

## Server info

```
GET https://app.surfdata.io/mcp/http
```

Returns server metadata without authentication:

```json
{
  "name": "surf-data-mcp",
  "version": "1.0.0",
  "protocol": "MCP",
  "protocolVersion": "2024-11-05",
  "authentication": {
    "type": "bearer",
    "header": "Authorization"
  }
}
```

---

## Methods

### initialize

Handshake with the server. Returns capabilities and protocol version.

**Request:**

```json
{
  "jsonrpc": "2.0",
  "method": "initialize",
  "params": {
    "protocolVersion": "2024-11-05",
    "capabilities": {},
    "clientInfo": {
      "name": "my-agent",
      "version": "1.0.0"
    }
  },
  "id": 1
}
```

**Response:**

```json
{
  "jsonrpc": "2.0",
  "result": {
    "protocolVersion": "2024-11-05",
    "capabilities": {
      "tools": {}
    },
    "serverInfo": {
      "name": "surf-data-mcp",
      "version": "1.0.0"
    }
  },
  "id": 1
}
```

---

### tools/list

Lists all available tools for the authenticated project.

**Request:**

```json
{
  "jsonrpc": "2.0",
  "method": "tools/list",
  "id": 2
}
```

**Response:**

```json
{
  "jsonrpc": "2.0",
  "result": {
    "tools": [
      {
        "name": "get_customer_by_id",
        "description": "Retrieves customer details by their unique ID",
        "inputSchema": {
          "type": "object",
          "properties": {
            "customer_id": {
              "type": "string",
              "description": "The unique customer identifier"
            }
          },
          "required": ["customer_id"]
        }
      },
      {
        "name": "search_orders",
        "description": "Searches orders by customer ID and optional date range",
        "inputSchema": {
          "type": "object",
          "properties": {
            "customer_id": {
              "type": "string",
              "description": "Customer ID to search orders for"
            },
            "start_date": {
              "type": "string",
              "description": "Start date in YYYY-MM-DD format"
            }
          },
          "required": ["customer_id"]
        }
      }
    ]
  },
  "id": 2
}
```

---

### tools/call

Executes a tool with the provided arguments.

**Request:**

```json
{
  "jsonrpc": "2.0",
  "method": "tools/call",
  "params": {
    "name": "get_customer_by_id",
    "arguments": {
      "customer_id": "12345"
    }
  },
  "id": 3
}
```

**Response (success):**

```json
{
  "jsonrpc": "2.0",
  "result": {
    "content": [
      {
        "type": "text",
        "text": "[{\"id\":\"12345\",\"name\":\"Jo√£o Silva\",\"email\":\"joao@example.com\",\"plan\":\"growth\"}]"
      }
    ]
  },
  "id": 3
}
```

**Response (error):**

```json
{
  "jsonrpc": "2.0",
  "result": {
    "content": [
      {
        "type": "text",
        "text": "Error: Tool 'unknown_tool' not found"
      }
    ],
    "isError": true
  },
  "id": 3
}
```

### Execution pipeline

When `tools/call` is invoked, the following pipeline executes:

<Steps>
  <Step title="Token validation">
    Verify the Bearer token is valid, active, and not expired.
  </Step>
  <Step title="Limit check">
    Check the organization's monthly execution quota.
  </Step>
  <Step title="Tool lookup">
    Find the requested tool by name in the project.
  </Step>
  <Step title="Parameter substitution">
    Replace `{parameter}` placeholders with provided argument values. Values are escaped to prevent SQL injection.
  </Step>
  <Step title="Query safety check">
    Validate the query doesn't contain destructive SQL patterns (DROP, DELETE, UPDATE, INSERT, ALTER, TRUNCATE, CREATE, GRANT, REVOKE).
  </Step>
  <Step title="Add row limit">
    If the query doesn't already have a LIMIT clause, add `LIMIT 100`.
  </Step>
  <Step title="Execute query">
    Connect to the datasource (decrypting credentials) and run the query with a timeout.
  </Step>
  <Step title="Apply policies">
    If masking policies are enabled, apply them to the result set.
  </Step>
  <Step title="Log invocation">
    Record the execution details (tool, parameters, duration, status, row count).
  </Step>
  <Step title="Track usage">
    Increment the organization's execution counter.
  </Step>
  <Step title="Return results">
    Return the query results (capped at 100 rows) to the agent.
  </Step>
</Steps>

---

### ping

Health check endpoint.

**Request:**

```json
{
  "jsonrpc": "2.0",
  "method": "ping",
  "id": 4
}
```

**Response:**

```json
{
  "jsonrpc": "2.0",
  "result": {},
  "id": 4
}
```

---

## Error codes

| Code | Message | Description |
|------|---------|-------------|
| `-32600` | Invalid request | Malformed JSON-RPC request |
| `-32601` | Method not found | Unknown MCP method name |
| `-32602` | Invalid params | Missing or invalid parameters |
| `-32603` | Internal error | Unexpected server error |

### Application errors

| Error | Cause | Resolution |
|-------|-------|------------|
| Missing authorization header | No `Authorization` header | Add `Authorization: Bearer <token>` |
| Invalid token | Token not found or invalid format | Check token value |
| Token is inactive | Token deactivated | Reactivate or generate new token |
| Token has expired | Past expiration date | Generate a new token |
| Project not published | Project is unpublished | Publish the project first |
| Execution limit reached | Monthly quota exceeded | Upgrade plan or wait for reset |
| Tool not found | Tool name doesn't match | Check `tools/list` for valid names |
| Dangerous query detected | Destructive SQL blocked | Fix the query to be read-only |

## Limits

| Limit | Value |
|-------|-------|
| Max result rows | 100 |
| Query timeout | Platform-defined |
| Max execution count | Plan-dependent (5K to unlimited) |
| Request body size | Standard HTTP limits |
