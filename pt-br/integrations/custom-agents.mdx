---
title: "Agentes Personalizados"
description: "Integre o Surf Data com qualquer agente compatível com MCP ou construa o seu próprio"
---

## Visão geral

O endpoint MCP do Surf Data é compatível com qualquer cliente que suporte o **Model Context Protocol**. Você pode integrar com frameworks de agentes existentes, agentes personalizados ou plataformas de automação.

## Endpoint MCP

```
POST https://surfdata.com.br/mcp/http
```

Autenticação:
```
Authorization: Bearer sk_live_your-token-here
Content-Type: application/json
```

## Protocolo

O Surf Data utiliza **JSON-RPC 2.0** sobre HTTP. Toda requisição e resposta segue este formato:

### Requisição

```json
{
  "jsonrpc": "2.0",
  "method": "method_name",
  "params": {},
  "id": 1
}
```

### Resposta

```json
{
  "jsonrpc": "2.0",
  "result": {},
  "id": 1
}
```

## Métodos disponíveis

### Inicializar

Handshake com o servidor MCP. Chame este método primeiro para obter as capacidades do servidor.

```json
{
  "jsonrpc": "2.0",
  "method": "initialize",
  "params": {
    "protocolVersion": "2024-11-05",
    "capabilities": {},
    "clientInfo": {
      "name": "my-agent",
      "version": "1.0.0"
    }
  },
  "id": 1
}
```

**Resposta:**

```json
{
  "jsonrpc": "2.0",
  "result": {
    "protocolVersion": "2024-11-05",
    "capabilities": {
      "tools": {}
    },
    "serverInfo": {
      "name": "surf-data-mcp",
      "version": "1.0.0"
    }
  },
  "id": 1
}
```

### Listar ferramentas

Descubra as ferramentas disponíveis e seus schemas de entrada.

```json
{
  "jsonrpc": "2.0",
  "method": "tools/list",
  "id": 2
}
```

**Resposta:**

```json
{
  "jsonrpc": "2.0",
  "result": {
    "tools": [
      {
        "name": "get_customer_by_id",
        "description": "Retrieves customer details by their ID",
        "inputSchema": {
          "type": "object",
          "properties": {
            "customer_id": {
              "type": "string",
              "description": "The unique customer identifier"
            }
          },
          "required": ["customer_id"]
        }
      }
    ]
  },
  "id": 2
}
```

### Chamar uma ferramenta

Execute uma ferramenta com argumentos.

```json
{
  "jsonrpc": "2.0",
  "method": "tools/call",
  "params": {
    "name": "get_customer_by_id",
    "arguments": {
      "customer_id": "12345"
    }
  },
  "id": 3
}
```

**Resposta:**

```json
{
  "jsonrpc": "2.0",
  "result": {
    "content": [
      {
        "type": "text",
        "text": "[{\"id\": \"12345\", \"name\": \"João Silva\", \"email\": \"j***@example.com\", \"plan\": \"growth\"}]"
      }
    ]
  },
  "id": 3
}
```

### Ping

Endpoint de verificação de saúde.

```json
{
  "jsonrpc": "2.0",
  "method": "ping",
  "id": 4
}
```

## Exemplos de integração

### Python com MCP SDK

```python
from mcp import ClientSession
from mcp.client.streamable_http import streamablehttp_client

async def main():
    headers = {"Authorization": "Bearer sk_live_your-token-here"}

    async with streamablehttp_client(
        "https://surfdata.com.br/mcp/http",
        headers=headers
    ) as (read, write, _):
        async with ClientSession(read, write) as session:
            await session.initialize()

            # List available tools
            tools = await session.list_tools()
            print(f"Available tools: {[t.name for t in tools.tools]}")

            # Call a tool
            result = await session.call_tool(
                "get_customer_by_id",
                arguments={"customer_id": "12345"}
            )
            print(result)
```

### Node.js com fetch

```javascript
async function callMCP(method, params = {}) {
  const response = await fetch('https://surfdata.com.br/mcp/http', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': 'Bearer sk_live_your-token-here'
    },
    body: JSON.stringify({
      jsonrpc: '2.0',
      method,
      params,
      id: Date.now()
    })
  });
  return response.json();
}

// List tools
const tools = await callMCP('tools/list');
console.log(tools.result.tools);

// Call a tool
const result = await callMCP('tools/call', {
  name: 'get_customer_by_id',
  arguments: { customer_id: '12345' }
});
console.log(result.result);
```

### cURL

```bash
# Initialize
curl -X POST https://surfdata.com.br/mcp/http \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk_live_your-token-here" \
  -d '{
    "jsonrpc": "2.0",
    "method": "initialize",
    "params": {
      "protocolVersion": "2024-11-05",
      "capabilities": {},
      "clientInfo": {"name": "curl-test", "version": "1.0.0"}
    },
    "id": 1
  }'

# List tools
curl -X POST https://surfdata.com.br/mcp/http \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk_live_your-token-here" \
  -d '{"jsonrpc": "2.0", "method": "tools/list", "id": 2}'

# Call a tool
curl -X POST https://surfdata.com.br/mcp/http \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk_live_your-token-here" \
  -d '{
    "jsonrpc": "2.0",
    "method": "tools/call",
    "params": {
      "name": "get_customer_by_id",
      "arguments": {"customer_id": "12345"}
    },
    "id": 3
  }'
```

## Tratamento de erros

Erros MCP seguem o formato de erro JSON-RPC 2.0:

```json
{
  "jsonrpc": "2.0",
  "error": {
    "code": -32600,
    "message": "Invalid token"
  },
  "id": 1
}
```

### Códigos de erro comuns

| Código | Mensagem | Causa |
|--------|----------|-------|
| `-32600` | Invalid token | Token inválido, expirado ou revogado |
| `-32601` | Method not found | Método MCP desconhecido |
| `-32602` | Invalid params | Parâmetros ausentes ou inválidos |
| `-32603` | Internal error | Erro no servidor |
| `-32001` | Limit reached | Limite mensal de execuções excedido |
| `-32002` | Tool not found | A ferramenta solicitada não existe |
| `-32003` | Query blocked | SQL destrutivo detectado |
